<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#1a0b0b">
    <title>For Chaithra C - The Coffee Queen</title>
    
    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Playfair+Display:ital,wght@0,400;0,600;0,800;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons for Realistic UI -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        /* =========================================
           1. CORE VARIABLES & RESET
           ========================================= */
        :root {
            /* Palette */
            --c-bg-dark: #0f0505;
            --c-bg-panel: #1a0b0b;
            --c-coffee-dark: #2c1a1d;
            --c-coffee: #6f4e37;
            --c-coffee-light: #8d6e63;
            --c-cream: #f3e5ab;
            --c-gold: #d4af37;
            --c-gold-dim: #8a7223;
            --c-gold-glow: #ffd700;
            --c-diamond: #e0f7fa;
            --c-diamond-sparkle: #ffffff;
            --c-text-main: #fcfcfc;
            --c-text-muted: #bcaaa4;
            --c-glass: rgba(255, 255, 255, 0.03);
            --c-glass-border: rgba(255, 215, 0, 0.15);

            /* Typography */
            --font-display: 'Cinzel Decorative', cursive;
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Lato', sans-serif;

            /* Dimensions */
            --nav-height: 85px;
            --safe-area-bottom: env(safe-area-inset-bottom, 20px);
            
            /* Animation Curves */
            --ease-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --ease-out: cubic-bezier(0.0, 0.0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background-color: var(--c-bg-dark);
        }

        body {
            font-family: var(--font-sans);
            color: var(--c-text-main);
            display: flex;
            flex-direction: column;
            position: relative;
            /* Luxurious subtle grain texture */
            background-image: 
                radial-gradient(circle at 50% 0%, var(--c-coffee-dark), var(--c-bg-dark) 80%),
                url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
        }

        /* =========================================
           2. UTILITIES & ANIMATIONS
           ========================================= */
        .hidden { display: none !important; }
        .invisible { opacity: 0 !important; pointer-events: none !important; }
        
        .gold-text {
            color: var(--c-gold);
            text-shadow: 0 2px 15px rgba(212, 175, 55, 0.4);
            background: linear-gradient(to bottom, #ffd700, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }

        .gold-border {
            border: 1px solid var(--c-gold);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }

        /* Keyframes */
        @keyframes float-y {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse-soft {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        @keyframes rotate-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        @keyframes entrance-scale {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* =========================================
           3. CANVAS & PARTICLES
           ========================================= */
        #particle-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* Behind content */
            pointer-events: none;
        }

        /* =========================================
           4. FLOATING OVERLAYS
           ========================================= */
        #floating-text-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100; /* Above everything */
            pointer-events: none;
            overflow: hidden;
        }

        .floating-message {
            position: absolute;
            font-family: var(--font-display);
            color: var(--c-gold);
            font-size: 1.5rem;
            text-align: center;
            width: auto;
            white-space: nowrap;
            text-shadow: 0 4px 15px rgba(0,0,0,0.9);
            pointer-events: none;
            will-change: transform, opacity;
            z-index: 100;
        }

        /* =========================================
           5. LOADER
           ========================================= */
        #app-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--c-bg-dark);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease-out;
        }

        .loader-cup {
            font-size: 4rem;
            color: var(--c-gold);
            animation: pulse-soft 2s infinite;
        }

        .loader-text {
            margin-top: 20px;
            font-family: var(--font-serif);
            color: var(--c-cream);
            font-size: 1.2rem;
            letter-spacing: 2px;
            opacity: 0.8;
        }

        /* =========================================
           6. MAIN LAYOUT & SECTIONS
           ========================================= */
        main {
            position: relative;
            width: 100%;
            height: 100%;
            z-index: 10;
            overflow: hidden;
        }

        section {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 20px;
            padding-bottom: calc(var(--nav-height) + 30px);
            padding-top: 60px; /* Safe area top */
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Default State: Hidden & Gone */
            opacity: 0;
            visibility: hidden; 
            transform: scale(0.95);
            /* We handle transitions manually in JS to prevent overlap */
            transition: opacity 0.5s var(--ease-smooth), transform 0.5s var(--ease-smooth);
        }

        section.active {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
            pointer-events: auto;
        }

        /* Headers */
        h2.section-title {
            font-family: var(--font-display);
            font-size: 2rem;
            margin-bottom: 10px;
            text-align: center;
            color: var(--c-gold);
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        p.section-subtitle {
            font-family: var(--font-serif);
            font-style: italic;
            color: var(--c-text-muted);
            margin-bottom: 30px;
            text-align: center;
            font-size: 0.95rem;
        }

        /* =========================================
           7. TAB: MAGIC (HOME)
           ========================================= */
        .coffee-stage {
            position: relative;
            width: 100%;
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        .cup-wrapper {
            position: relative;
            width: 220px;
            height: 180px;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }

        .cup-body {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 160px;
            height: 130px;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            border-radius: 0 0 80px 80px;
            box-shadow: 
                inset -5px 0 20px rgba(0,0,0,0.1), 
                0 20px 50px rgba(0,0,0,0.6),
                0 0 0 2px rgba(255,255,255,0.1);
            overflow: hidden;
            z-index: 5;
        }

        .cup-rim {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: #fff;
            z-index: 10;
        }

        .liquid {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0%;
            background: linear-gradient(to top, #2e1a15, #6f4e37);
            transition: height 4s cubic-bezier(0.37, 0, 0.63, 1);
            z-index: 15;
        }

        .liquid::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.1);
            animation: shimmer 2s infinite linear;
        }

        /* BRAND LABEL ON CUP - NEWLY ADDED */
        .cup-label {
            position: absolute;
            top: 60%; /* "Little down" as requested */
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            text-align: center;
            font-family: var(--font-display);
            font-weight: 900;
            font-size: 1.1rem;
            color: var(--c-gold); /* Gold to match and stand out against dark liquid */
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            z-index: 20; /* Above liquid */
            opacity: 0; /* Hidden initially */
            transition: opacity 2s ease-in;
            pointer-events: none;
            letter-spacing: 1px;
            line-height: 1.2;
        }

        .handle {
            position: absolute;
            right: 0px;
            top: 55px; /* Moved down to touch the cup body properly */
            width: 45px;
            height: 70px;
            border: 12px solid #e0e0e0;
            border-left: none;
            border-radius: 0 35px 35px 0;
            z-index: 1;
            box-shadow: 5px 10px 20px rgba(0,0,0,0.3);
        }

        .plate {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 220px;
            height: 25px;
            background: #dcdcdc;
            border-radius: 50%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            z-index: 0;
        }

        .btn-action {
            position: relative;
            background: linear-gradient(135deg, var(--c-bg-panel), var(--c-bg-dark));
            border: 1px solid var(--c-gold);
            color: var(--c-gold);
            padding: 20px 40px;
            font-family: var(--font-display);
            font-size: 1rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            overflow: hidden;
            transition: all 0.3s ease;
            z-index: 20;
            margin-bottom: 20px;
        }

        .btn-action::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-action:active {
            transform: scale(0.95);
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
        }

        /* =========================================
           8. TAB: APPRECIATIONS (FAMILY)
           ========================================= */
        .reviews-container {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            padding: 10px;
            /* Scrollbar hiding */
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .reviews-container::-webkit-scrollbar { display: none; }

        .review-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--c-glass-border);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            position: relative;
            transform-origin: center bottom;
            animation: entrance-scale 0.6s backwards;
        }

        .review-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .avatar-placeholder {
            width: 40px;
            height: 40px;
            background: var(--c-gold-dim);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #fff;
            margin-right: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .reviewer-name {
            font-family: var(--font-serif);
            font-size: 1.1rem;
            color: var(--c-cream);
        }

        .review-text {
            color: var(--c-text-muted);
            font-style: italic;
            line-height: 1.6;
            font-size: 1rem;
        }

        .review-emotion {
            display: inline-block;
            margin-top: 12px;
            padding: 4px 12px;
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 20px;
            color: var(--c-gold);
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        /* =========================================
           9. TAB: BLESSINGS (PRO 3D CARDS)
           ========================================= */
        .blessings-viewport {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            perspective: 1200px;
        }

        .blessing-card-container {
            position: relative;
            width: 85%;
            max-width: 340px;
            height: 450px;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        /* The actual cards stacked */
        .blessing-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e1e1e, #2a2a2a);
            border: 2px solid var(--c-gold);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.6), inset 0 0 30px rgba(212, 175, 55, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            text-align: center;
            backface-visibility: hidden;
            transition: transform 0.8s var(--ease-elastic), opacity 0.5s ease;
        }

        .blessing-icon {
            font-size: 4rem;
            color: var(--c-gold);
            margin-bottom: 20px;
            filter: drop-shadow(0 0 15px var(--c-gold));
        }

        .blessing-title {
            font-family: var(--font-display);
            font-size: 1.8rem;
            color: var(--c-cream);
            margin-bottom: 15px;
        }

        .blessing-kannada {
            font-family: var(--font-serif);
            font-size: 1.2rem;
            color: var(--c-gold);
            line-height: 1.5;
        }

        .tap-instruction {
            margin-top: 30px;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: pulse-soft 2s infinite;
        }

        /* =========================================
           10. TAB: RECORD (CERTIFICATE)
           ========================================= */
        .certificate-container {
            position: relative;
            border: 8px double var(--c-gold);
            padding: 40px 20px;
            width: 90%;
            max-width: 400px;
            background: radial-gradient(circle, #2a1a1a, #0f0505);
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.15);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .cert-badge {
            font-size: 4rem;
            color: var(--c-gold);
            margin-bottom: 10px;
            animation: float-y 4s ease-in-out infinite;
        }

        .cert-title {
            font-family: var(--font-display);
            font-size: 1.2rem;
            color: var(--c-text-muted);
            letter-spacing: 4px;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .cert-rank {
            font-size: 5rem;
            font-weight: 900;
            background: linear-gradient(to bottom, #fff, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-family: var(--font-serif);
            line-height: 1;
        }

        .cert-subtitle {
            color: var(--c-cream);
            font-size: 1rem;
            margin-top: 10px;
            font-family: var(--font-serif);
        }

        .cert-quote {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--c-gold);
            font-style: italic;
        }

        /* =========================================
           11. TAB: DIAMONDS (JEWEL)
           ========================================= */
        .diamond-stage {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* The Overlay */
        .jewel-hint-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            padding: 40px;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            text-align: center;
            z-index: 50;
            transition: opacity 0.4s ease, transform 0.4s ease;
            cursor: pointer;
        }

        .jewel-hint-text {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            color: var(--c-text-main);
            line-height: 1.4;
        }

        .jewel-hint-sub {
            display: block;
            margin-top: 15px;
            font-size: 0.9rem;
            color: var(--c-gold);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* State: Vanished */
        .jewel-hint-overlay.vanished {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            pointer-events: none;
        }

        /* Bottom text for jewel tab */
        .jewel-footer {
            position: absolute;
            bottom: 40px;
            width: 100%;
            text-align: center;
            pointer-events: none;
        }

        /* =========================================
           12. NAVIGATION BAR (Glassmorphism)
           ========================================= */
        nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 94%;
            max-width: 420px;
            height: var(--nav-height);
            background: rgba(22, 11, 11, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 30px;
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            padding-bottom: 5px;
        }

        .nav-item {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 100%;
            color: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.4s var(--ease-elastic);
        }

        .nav-icon-box {
            font-size: 1.6rem;
            margin-bottom: 4px;
            transition: transform 0.3s ease;
            position: relative;
            z-index: 2;
        }

        .nav-label {
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        /* Active State */
        .nav-item.active {
            color: var(--c-gold);
        }

        .nav-item.active .nav-icon-box {
            transform: translateY(-5px);
            filter: drop-shadow(0 0 8px var(--c-gold));
        }

        .nav-item.active .nav-label {
            opacity: 1;
            color: #fff;
        }

        /* Active Indicator Dot */
        .nav-item::after {
            content: '';
            position: absolute;
            bottom: 12px;
            width: 4px;
            height: 4px;
            background: var(--c-gold);
            border-radius: 50%;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s ease;
        }

        .nav-item.active::after {
            opacity: 1;
            transform: scale(1);
        }

    </style>
</head>
<body>

    <!-- 0. Loader -->
    <div id="app-loader">
        <i class="ph-fill ph-coffee loader-cup"></i>
        <div class="loader-text">Papu Devate kandama's Coffee...</div>
    </div>

    <!-- 1. Background Canvas -->
    <canvas id="particle-canvas"></canvas>

    <!-- 2. Floating Text Layer -->
    <div id="floating-text-container"></div>

    <!-- 3. Main Content Area -->
    <main>
        
        <!-- Tab 1: Magic -->
        <section id="tab-magic" class="active">
            <h2 class="section-title">Chaithru's Best Coffee</h2>
            <p class="section-subtitle">Tap below to pour divine appreciation</p>

            <div class="coffee-stage">
                <div class="cup-wrapper" id="cup-wrapper">
                    <div class="cup-body">
                        <div class="cup-rim"></div>
                        <div class="liquid" id="liquid"></div>
                        <!-- BRAND LABEL -->
                        <div class="cup-label" id="cup-label">CS Brand Coffee</div>
                    </div>
                    <div class="handle"></div>
                    <div class="plate"></div>
                </div>
            </div>

            <button class="btn-action" id="btn-brew">
                Edu Just Random Appreciations
            </button>
        </section>

        <!-- Tab 2: Family -->
        <section id="tab-family">
            <h2 class="section-title">Family's Verdict</h2>
            <p class="section-subtitle">Everyone who tasted the magic</p>
            <div class="reviews-container" id="reviews-list">
                <!-- Injected via JS -->
            </div>
        </section>

        <!-- Tab 3: Blessings (Pro 3D Cards) -->
        <section id="tab-blessings">
            <h2 class="section-title">Divine Blessings</h2>
            <p class="section-subtitle">Tap card to reveal next blessing</p>
            
            <div class="blessings-viewport">
                <div class="blessing-card-container" id="card-stack">
                    <!-- Cards Injected via JS -->
                </div>
            </div>
        </section>

        <!-- Tab 4: Record -->
        <section id="tab-record">
            <h2 class="section-title">Universe Record</h2>
            <p class="section-subtitle">Official Certification</p>
            
            <div class="certificate-container">
                <i class="ph-fill ph-seal-check cert-badge"></i>
                <div class="cert-title">Rank</div>
                <div class="cert-rank">#1</div>
                <div class="cert-subtitle">Coffee in the Cosmos</div>
                <div class="cert-quote">"Ee coffee universe record madide"</div>
            </div>
        </section>

        <!-- Tab 5: Jewel -->
        <section id="tab-jewel">
            <h2 class="section-title">Precious Gem</h2>
            
            <div class="diamond-stage" id="diamond-stage">
                <!-- Overlay Logic -->
                <div class="jewel-hint-overlay" id="jewel-overlay">
                    <p class="jewel-hint-text">Why coffee was so best reason...</p>
                    <span class="jewel-hint-sub">(Tap to find out)</span>
                </div>
            </div>

            <div class="jewel-footer">
                <h3 class="gold-text">Like You</h3>
            </div>
        </section>

    </main>

    <!-- 4. Navigation -->
    <nav>
        <div class="nav-item active" onclick="app.switchTab('tab-magic')">
            <i class="nav-icon-box ph-fill ph-coffee"></i>
            <span class="nav-label">Magic</span>
        </div>
        <div class="nav-item" onclick="app.switchTab('tab-family')">
            <i class="nav-icon-box ph-fill ph-heart"></i>
            <span class="nav-label">Family</span>
        </div>
        <div class="nav-item" onclick="app.switchTab('tab-blessings')">
            <i class="nav-icon-box ph-fill ph-sparkle"></i>
            <span class="nav-label">Divine</span>
        </div>
        <div class="nav-item" onclick="app.switchTab('tab-record')">
            <i class="nav-icon-box ph-fill ph-trophy"></i>
            <span class="nav-label">Record</span>
        </div>
        <div class="nav-item" onclick="app.switchTab('tab-jewel')">
            <i class="nav-icon-box ph-fill ph-diamond"></i>
            <span class="nav-label">Jewel</span>
        </div>
    </nav>

    <script>
        /**
         * =========================================
         * CHAITHRA'S COFFEE MAGIC - PRO ENGINE
         * =========================================
         */

        const APP_DATA = {
            messages: [
                "Ninu nanna pancha prana kandama",
                "Ninu madidu coffee thumba thumba infinity astu esta aythu",
                "Papu devate kandama",
                "Ee coffee alli ninna preethi ide",
                "Nin muddina ganda kandama loves you",
                "Divine Taste!",
                "Blessed Hands!"
            ],
            reviews: [
                { name: "Appa", text: "Simple aagi helbeku andre... Adbhuta!", emotion: "Proud Father" },
                { name: "Amma", text: "Yen ruci kanda... Kai gunana idu.", emotion: "Happy Mother" },
                { name: "Bigie", text: "Best coffee ever tasted!", emotion: "Amazed" },
                { name: "Bavi", text: "Inond cup beku!", emotion: "Delighted" },
                { name: "Ganda", text: "Nin kai inda bandiro ee coffee kudiyoke thumba punya madedini bangara", emotion: "YOUR HUSBAND FOREVER" }
            ],
            blessings: [
                { icon: "ph-heart", title: "Pancha Prana", text: "Ninu nanna pancha prana kandama" },
                { icon: "ph-crown", title: "Devate", text: "Papu Devate Neenu" },
                { icon: "ph-baby", title: "Kandama", text: "Muddina Kandama Forever" },
                { icon: "ph-star", title: "Infinity", text: "Preethi Infinity Astu Ide" }
            ]
        };

        class AppController {
            constructor() {
                this.currentTab = 'tab-magic';
                this.isTransitioning = false;
                this.isBrewing = false;
                
                this.particleSystem = new ParticleSystem();
                
                this.init();
            }

            init() {
                // Loader
                window.addEventListener('load', () => {
                    setTimeout(() => {
                        document.getElementById('app-loader').style.opacity = '0';
                        setTimeout(() => document.getElementById('app-loader').remove(), 800);
                        this.particleSystem.spawnAmbience();
                    }, 1500);
                });

                this.renderReviews();
                this.renderBlessingCards();
                this.setupJewelLogic();
                this.setupBrewingLogic();
            }

            // --- STRICT TAB SWITCHING LOGIC ---
            switchTab(targetId) {
                if (this.currentTab === targetId || this.isTransitioning) return;
                
                this.isTransitioning = true;
                const oldSection = document.getElementById(this.currentTab);
                const newSection = document.getElementById(targetId);
                const navItems = document.querySelectorAll('.nav-item');

                // 1. Update Nav UI
                navItems.forEach(item => item.classList.remove('active'));
                const targetIndex = ['tab-magic', 'tab-family', 'tab-blessings', 'tab-record', 'tab-jewel'].indexOf(targetId);
                navItems[targetIndex].classList.add('active');

                // 2. Strict Exit (Wait for fade out)
                oldSection.classList.remove('active');
                
                setTimeout(() => {
                    // 3. Enter New Section
                    this.currentTab = targetId;
                    newSection.classList.add('active');
                    this.onTabEnter(targetId);
                    this.isTransitioning = false;
                }, 500); // Matches CSS transition duration
            }

            onTabEnter(tabId) {
                // Special logic for specific tabs
                if (tabId === 'tab-jewel') {
                    // Reset overlay visibility
                    const overlay = document.getElementById('jewel-overlay');
                    overlay.classList.remove('vanished');
                }
            }

            // --- CONTENT RENDERERS ---
            renderReviews() {
                const container = document.getElementById('reviews-list');
                APP_DATA.reviews.forEach((r, i) => {
                    const div = document.createElement('div');
                    div.className = 'review-card';
                    div.style.animationDelay = `${i * 0.1}s`;
                    div.innerHTML = `
                        <div class="review-header">
                            <div class="avatar-placeholder">${r.name[0]}</div>
                            <div class="reviewer-name">${r.name}</div>
                        </div>
                        <div class="review-text">"${r.text}"</div>
                        <div class="review-emotion">${r.emotion}</div>
                    `;
                    container.appendChild(div);
                });
            }

            renderBlessingCards() {
                const stack = document.getElementById('card-stack');
                // Create cards in reverse order so first is on top visually via z-index
                [...APP_DATA.blessings].reverse().forEach((b, i) => {
                    const card = document.createElement('div');
                    card.className = 'blessing-card';
                    // Stacking effect
                    card.style.transform = `translateZ(-${i * 40}px) translateY(-${i * 10}px)`;
                    card.style.zIndex = 10 - i;
                    card.innerHTML = `
                        <i class="ph-fill ${b.icon} blessing-icon"></i>
                        <h3 class="blessing-title">${b.title}</h3>
                        <p class="blessing-kannada">"${b.text}"</p>
                        <div class="tap-instruction">Tap for next blessing</div>
                    `;
                    
                    // Tap Interaction to cycle cards
                    card.onclick = (e) => {
                        e.stopPropagation();
                        // Fly out animation
                        card.style.transform = `translate(150%, -50%) rotate(20deg)`;
                        card.style.opacity = '0';
                        
                        setTimeout(() => {
                            // Move to bottom of stack logic (visual reset only for demo loop)
                            stack.prepend(card);
                            // Reset style after it's behind
                            requestAnimationFrame(() => {
                                card.style.transition = 'none';
                                card.style.transform = `translateZ(-120px) translateY(-30px)`;
                                card.style.opacity = '1';
                                card.style.zIndex = 0;
                                
                                // Re-enable transition and organize stack
                                setTimeout(() => {
                                    card.style.transition = '';
                                    this.restackCards();
                                }, 50);
                            });
                        }, 500);
                    };
                    stack.appendChild(card);
                });
            }

            restackCards() {
                const cards = document.querySelectorAll('.blessing-card');
                // We need to re-assign transforms based on visual order
                // The last child in DOM is visually on top usually if absolute, 
                // but here we appended in reverse. 
                // Let's just reset all based on current DOM order
                const reversed = [...cards].reverse(); // Top card is last in DOM
                reversed.forEach((card, i) => {
                    card.style.zIndex = 10 - i;
                    card.style.transform = `translateZ(-${i * 40}px) translateY(-${i * 10}px)`;
                });
            }

            // --- JEWEL LOGIC (UPDATED WITH WORDS) ---
            setupJewelLogic() {
                const overlay = document.getElementById('jewel-overlay');
                const stage = document.getElementById('diamond-stage');
                
                // Emotional words to appear on tap
                const clickWords = ["Best", " Best Soul", "Devate", "Nin Preethi", "Gem", "Angel", "Life", "Queen", "Pure", "Precious", "Nin Kai Guna", "Magic"];

                stage.addEventListener('click', (e) => {
                    // 1. Vanish Overlay
                    if (!overlay.classList.contains('vanished')) {
                        overlay.classList.add('vanished');
                    }
                    
                    // 2. Spawn Diamond Rain (Sugar/Gems)
                    for(let i=0; i<12; i++) {
                        this.particleSystem.spawnAt(e.clientX, e.clientY, 'diamond');
                    }

                    // 3. Spawn Small Word (New Feature)
                    const word = clickWords[Math.floor(Math.random() * clickWords.length)];
                    this.spawnClickWord(e.clientX, e.clientY, word);
                });
            }

            spawnClickWord(x, y, text) {
                const container = document.getElementById('floating-text-container');
                const el = document.createElement('div');
                el.innerText = text;
                
                // Style for mini words to look like gems/sugar text
                Object.assign(el.style, {
                    position: 'absolute',
                    left: `${x}px`,
                    top: `${y}px`,
                    color: '#fff', 
                    fontFamily: 'var(--font-serif)',
                    fontSize: '1.3rem',
                    fontWeight: 'bold',
                    textShadow: '0 0 15px var(--c-gold)',
                    pointerEvents: 'none',
                    zIndex: '1000',
                    transform: 'translate(-50%, -50%)',
                    whiteSpace: 'nowrap'
                });

                container.appendChild(el);

                // Quick Floating Animation
                const anim = el.animate([
                    { transform: 'translate(-50%, -50%) scale(0.2)', opacity: 0, offset: 0 },
                    { transform: 'translate(-50%, -80px) scale(1.2)', opacity: 1, offset: 0.3 },
                    { transform: 'translate(-50%, -180px) scale(1)', opacity: 0, offset: 1 }
                ], {
                    duration: 1200,
                    easing: 'ease-out'
                });

                anim.onfinish = () => el.remove();
            }

            // --- BREWING LOGIC ---
            setupBrewingLogic() {
                const btn = document.getElementById('btn-brew');
                const liquid = document.getElementById('liquid');
                const cupLabel = document.getElementById('cup-label'); // Get the label

                btn.addEventListener('click', () => {
                    if (this.isBrewing) return;
                    this.isBrewing = true;
                    btn.disabled = true;

                    // PHASE 1: FILL COFFEE (0s)
                    liquid.style.height = '85%';
                    // REVEAL LABEL NOW
                    cupLabel.style.opacity = '1';
                    
                    btn.innerText = "Heating Up...";
                    
                    // PHASE 2: ADDING SUGAR/MAGIC (starts at 1.5s)
                    setTimeout(() => {
                        btn.innerText = "Adding Sugar & Magic...";
                        // Spawn falling sprinkles/diamonds into cup center
                        const rect = document.querySelector('.cup-body').getBoundingClientRect();
                        const centerX = rect.left + rect.width/2;
                        const centerY = rect.top; // Above cup
                        
                        // Burst of 'sugar' particles
                        for(let i=0; i<15; i++) {
                            setTimeout(() => {
                                this.particleSystem.spawnAt(centerX + (Math.random()-0.5)*40, centerY - 50, 'diamond');
                            }, i * 100);
                        }
                    }, 1500);

                    // PHASE 3: AROMA/STEAM (starts at 3.0s)
                    let steamTimer;
                    setTimeout(() => {
                        btn.innerText = "Releasing Divine Aroma...";
                        steamTimer = setInterval(() => {
                            const rect = document.querySelector('.cup-body').getBoundingClientRect();
                            this.particleSystem.spawnAt(rect.left + rect.width/2, rect.top + 40, 'steam');
                        }, 150);
                    }, 3000);

                    // PHASE 4: FLOATING MESSAGES (starts at 4.5s)
                    let msgIndex = 0;
                    setTimeout(() => {
                        btn.innerText = "Manifesting Love...";
                        let msgTimer = setInterval(() => {
                            if (msgIndex >= APP_DATA.messages.length) {
                                clearInterval(msgTimer);
                                clearInterval(steamTimer);
                                this.isBrewing = false;
                                btn.disabled = false;
                                btn.innerText = "Enjoy Kandama!";
                                this.particleSystem.explodeConfetti();
                                return;
                            }
                            this.spawnFloatingText(APP_DATA.messages[msgIndex]);
                            msgIndex++;
                        }, 1200);
                    }, 4500);
                });
            }

            spawnFloatingText(text) {
                const container = document.getElementById('floating-text-container');
                const el = document.createElement('div');
                el.className = 'floating-message';
                el.innerText = text;
                
                // Position explicitly in center before translating
                el.style.left = '50%';
                el.style.top = '50%';
                
                // Randomize start position slightly (relative to center)
                const randomX = (Math.random() - 0.5) * 60; 
                
                // Start a bit lower (near cup) and invisible
                el.style.transform = `translate(${randomX}px, 0px) scale(0.5)`; 
                el.style.opacity = '0';

                container.appendChild(el);

                // Complex Animation via Web Animations API
                const anim = el.animate([
                    { transform: `translate(-50%, 0px) translate(${randomX}px, 20px) scale(0.5)`, opacity: 0, offset: 0 },
                    { transform: `translate(-50%, 0px) translate(${randomX}px, -80px) scale(1.1)`, opacity: 1, offset: 0.2 }, 
                    { transform: `translate(-50%, 0px) translate(${randomX}px, -180px) scale(1)`, opacity: 1, offset: 0.8 }, 
                    { transform: `translate(-50%, 0px) translate(${randomX}px, -250px) scale(0.8)`, opacity: 0, offset: 1 } 
                ], {
                    duration: 4000,
                    easing: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)'
                });

                anim.onfinish = () => el.remove();
            }
        }

        /**
         * =========================================
         * PARTICLE PHYSICS ENGINE (Canvas)
         * =========================================
         */
        class ParticleSystem {
            constructor() {
                this.canvas = document.getElementById('particle-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                
                this.resize();
                window.addEventListener('resize', () => this.resize());
                this.loop();
            }

            resize() {
                this.width = this.canvas.width = window.innerWidth;
                this.height = this.canvas.height = window.innerHeight;
            }

            spawnAt(x, y, type) {
                this.particles.push(new Particle(x, y, type));
            }

            spawnAmbience() {
                // Background subtle dust
                setInterval(() => {
                    if (document.hidden) return;
                    this.particles.push(new Particle(Math.random()*this.width, Math.random()*this.height, 'dust'));
                }, 200);
            }

            explodeConfetti() {
                const cx = this.width / 2;
                const cy = this.height / 2;
                for(let i=0; i<80; i++) {
                    this.particles.push(new Particle(cx, cy, 'confetti'));
                }
            }

            loop() {
                this.ctx.clearRect(0, 0, this.width, this.height);
                
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const p = this.particles[i];
                    p.update();
                    p.draw(this.ctx);
                    if (p.life <= 0) this.particles.splice(i, 1);
                }

                requestAnimationFrame(() => this.loop());
            }
        }

        class Particle {
            constructor(x, y, type) {
                this.x = x;
                this.y = y;
                this.type = type;
                this.life = 1;
                
                if (type === 'steam') {
                    this.vx = (Math.random() - 0.5) * 1;
                    this.vy = -Math.random() * 2 - 1.5;
                    this.size = Math.random() * 15 + 10;
                    this.decay = 0.008;
                    this.color = 'rgba(255,255,255,0.15)';
                } else if (type === 'diamond') {
                    this.vx = (Math.random() - 0.5) * 6;
                    this.vy = Math.random() * -8 - 2;
                    this.gravity = 0.3;
                    this.size = Math.random() * 8 + 4;
                    this.decay = 0.01;
                    this.rotation = Math.random() * 360;
                    this.rotSpeed = (Math.random() - 0.5) * 15;
                } else if (type === 'confetti') {
                    this.vx = (Math.random() - 0.5) * 12;
                    this.vy = (Math.random() - 0.5) * 12 - 5;
                    this.gravity = 0.2;
                    this.size = Math.random() * 6 + 3;
                    this.decay = 0.01;
                    this.color = ['#ffd700', '#f3e5ab', '#ffffff'][Math.floor(Math.random() * 3)];
                    this.rotation = Math.random() * 360;
                } else if (type === 'dust') {
                    this.vx = (Math.random() - 0.5) * 0.5;
                    this.vy = (Math.random() - 0.5) * 0.5;
                    this.size = Math.random() * 2;
                    this.decay = 0.005;
                    this.color = 'rgba(212, 175, 55, 0.4)';
                }
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.life -= this.decay;

                if (this.gravity) this.vy += this.gravity;
                if (this.rotation !== undefined) this.rotation += (this.rotSpeed || 5);
            }

            draw(ctx) {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.globalAlpha = this.life;

                if (this.type === 'steam') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = this.color;
                    ctx.filter = 'blur(8px)';
                    ctx.fill();
                    ctx.filter = 'none';
                } else if (this.type === 'diamond') {
                    ctx.rotate(this.rotation * Math.PI / 180);
                    ctx.fillStyle = '#e0f7fa';
                    ctx.beginPath();
                    ctx.moveTo(0, -this.size);
                    ctx.lineTo(this.size, 0);
                    ctx.lineTo(0, this.size);
                    ctx.lineTo(-this.size, 0);
                    ctx.closePath();
                    ctx.fill();
                    ctx.shadowColor = 'white';
                    ctx.shadowBlur = 10;
                    ctx.stroke();
                } else if (this.type === 'confetti') {
                    ctx.rotate(this.rotation * Math.PI / 180);
                    ctx.fillStyle = this.color;
                    ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
                } else if (this.type === 'dust') {
                    ctx.beginPath();
                    ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 4;
                    ctx.shadowColor = 'gold';
                    ctx.fill();
                }
                ctx.restore();
            }
        }

        // Initialize App
        const app = new AppController();

    </script>
</body>
</html>

